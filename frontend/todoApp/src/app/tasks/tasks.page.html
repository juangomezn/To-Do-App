<ion-header>
  <ion-toolbar color="primary">
    <ion-title>Mis Tareas</ion-title>
    <ion-buttons slot="end">
      <ion-button (click)="logout()">
        <ion-icon name="log-out" slot="icon-only"></ion-icon>
      </ion-button>
    </ion-buttons>
  </ion-toolbar>

  <ion-toolbar color="primary">
    <ion-searchbar
      (ionInput)="onSearch($event)"
      placeholder="Buscar tareas..."
      mode="ios"
      color="light">
    </ion-searchbar>
  </ion-toolbar>
</ion-header>

<ion-content [fullscreen]="true" class="ion-padding">

  <ion-list *ngIf="filtered.length > 0; else noTasks">
    <ion-item-sliding *ngFor="let t of filtered" #slidingItem>

      <ion-item 
        (click)="editTask(t)"
        [class.task-completed]="t.status === 'completed'"
        [class.task-pending]="t.status === 'pending'"
        lines="full"
        detail="true">

        <ion-icon 
          slot="start"
          [name]="t.status === 'completed' ? 'checkmark-circle' : 'time'"
          [color]="t.status === 'completed' ? 'success' : 'warning'">
        </ion-icon>

        <ion-label>
          <h2>{{ t.title }}</h2>

          <p *ngIf="t.description" class="task-description">
            {{ t.description }}
          </p>

          <p class="task-status">
            Estado:
            <strong [style.color]="t.status === 'completed' ? 'green' : 'orange'">
              {{ t.status === 'completed' ? 'Completada' : 'Pendiente' }}
            </strong>
          </p>
        </ion-label>

      </ion-item>

      <ion-item-options side="end">
        <ion-item-option color="danger" (click)="deleteTask(t); slidingItem.close()">
          <ion-icon slot="icon-only" name="trash"></ion-icon>
        </ion-item-option>
      </ion-item-options>

    </ion-item-sliding>
  </ion-list>

  <ng-template #noTasks>
    <div class="ion-text-center ion-margin-top">
      <ion-icon name="list-outline" size="large" color="medium"></ion-icon>
      <p class="ion-padding-top">No hay tareas para mostrar.</p>
    </div>
  </ng-template>

  <ion-fab vertical="bottom" horizontal="end" slot="fixed">
    <ion-fab-button color="secondary" (click)="createTaskPrompt()">
      <ion-icon name="add"></ion-icon>
    </ion-fab-button>
  </ion-fab>

</ion-content>
